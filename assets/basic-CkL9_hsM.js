(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const h=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}],u={quantityChange:"quantity-change",removeItem:"remove-item"},D=(t,e)=>()=>{const o=t.value;e(o)},B=(t,e,o)=>{const s=t.target;if(s.classList.contains(u.quantityChange)){const n=s.dataset.productId,a=parseInt(s.dataset.change);e(n,a)}else if(s.classList.contains(u.removeItem)){const n=s.dataset.productId;o(n)}},O=(t,e)=>{const o=Math.floor(Math.random()*t.length),s=t[o];Math.random()<.3&&s.quantity>0&&(s.price=Math.round(s.price*.8),alert(`번개세일! ${s.name}이(가) 20% 할인 중입니다!`),e())},A=(t,e,o)=>{const s=t.find(n=>n.id!==e&&n.quantity>0);s&&(s.price=Math.round(s.price*.95),alert(`${s.name}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`),o())},H=(t,e,o,s)=>{let n=0,a=0,r=0;for(let d=0;d<t.length;d++){const l=t[d],v=l.id,S=e(v),g=o(l),E=S.price*g;a+=g,r+=E;let w=g>=10?s(v):0;n+=E*(1-w)}if(a>=30){const d=r*.25,l=r-n;d>l&&(n=r*.75)}let I=!1;new Date().getDay()===2&&(I=!0,n*=.9);const T=r>0?(r-n)/r:0,L=Math.floor(n/1e3);return{totalAmount:n,itemCount:a,subtotal:r,discountRate:T,isTuesdayDiscount:I,bonusPoints:L}},Q=t=>({p1:.1,p2:.15,p3:.2,p4:.05,p5:.25})[t]||0,k=(t,e)=>{let o=`총액: ${Math.round(t)}원`;return e>0&&(o+=`<span class="text-green-500 ml-2">(${(e*100).toFixed(1)}% 할인 적용)</span>`),o},R=t=>`
        <span>${t.name} - ${t.price}원 x 1</span>
        <div>
          <button class="${u.quantityChange} bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
          <button class="${u.quantityChange} bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
          <button class="${u.removeItem} bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
        </div>
    `,N=t=>`<span id="loyalty-points" class="text-blue-500 ml-2">(포인트: ${t})</span>`,U=()=>{let t="";return h.forEach(function(e){const o=e.quantity===0?"disabled":"";t+=`<option value="${e.id}" ${o}>${e.name} - ${e.price}원</option>`}),t},F=()=>{let t="";return h.forEach(function(e){e.quantity<5&&(t+=`${e.name}: ${e.quantity>0?"재고 부족 ("+e.quantity+"개 남음)":"품절"}<br>`)}),t},c={CartTotal:k,CartItem:R,Points:N,ProductOptions:U,StockStatus:F},i={products:[...h],lastSelectedProduct:null,bonusPoints:0,totalAmount:0,itemCount:0};let p,m,b,P,q;const j=()=>{K(),_(),z(),Y(),f()},K=()=>{const t=document.getElementById("app");t.innerHTML=`
    <div class="bg-gray-100 p-8">
      <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
        <h1 class="text-2xl font-bold mb-4">장바구니</h1>
        <div id="cart-items"></div>
        <div id="cart-total" class="text-xl font-bold my-4"></div>
        <div class="flex mb-4">
          <select id="product-select" class="border rounded p-2 mr-2">
            ${c.ProductOptions()}
          </select>
          <button id="add-to-cart" class="bg-blue-500 text-white px-4 py-2 rounded">추가</button>
        </div>
        <div id="stock-status" class="text-sm text-gray-500 mt-2"></div>
      </div>
    </div>
  `},_=()=>{p=document.getElementById("cart-items"),m=document.getElementById("cart-total"),b=document.getElementById("product-select"),P=document.getElementById("add-to-cart"),q=document.getElementById("stock-status")},z=()=>{P.addEventListener("click",D(b,G)),p.addEventListener("click",t=>B(t,$,M))},y=t=>i.products.find(e=>e.id===t),G=t=>{const e=y(t);if(!e||e.quantity<=0){alert("재고가 부족합니다.");return}if(document.getElementById(t))$(t,1);else{const s=J(e);p.appendChild(s),e.quantity--}i.lastSelectedProduct=t,f()},J=t=>{const e=document.createElement("div");return e.id=t.id,e.className="flex justify-between items-center mb-2",e.innerHTML=c.CartItem(t),e},$=(t,e)=>{const o=document.getElementById(t),s=y(t);if(!o||!s)return;const a=x(o)+e;if(a<=0){M(t);return}if(e>0&&s.quantity<=0){alert("재고가 부족합니다.");return}V(o,s,a),s.quantity-=e,f()},x=t=>parseInt(t.querySelector("span").textContent.split("x ")[1]),V=(t,e,o)=>{t.querySelector("span").textContent=`${e.name} - ${e.price}원 x ${o}`},M=t=>{const e=document.getElementById(t),o=y(t);if(!e||!o)return;const s=x(e);o.quantity+=s,e.remove(),f()},f=()=>{const t=H(p.children,y,x,Q);i.totalAmount=t.totalAmount,i.itemCount=t.itemCount,i.bonusPoints=t.bonusPoints,W(t.discountRate,t.isTuesdayDiscount),X()},W=(t,e)=>{e?m.innerHTML=`총액: ${Math.round(i.totalAmount)}원<span class="text-green-500 ml-2">(10.0% 할인 적용)</span>`:m.innerHTML=c.CartTotal(i.totalAmount,t);let o=document.getElementById("loyalty-points");o?o.innerHTML=`(포인트: ${i.bonusPoints})`:m.innerHTML+=c.Points(i.bonusPoints)},X=()=>{q.innerHTML=c.StockStatus()},Y=()=>{setTimeout(()=>{setInterval(()=>{O(i.products,C)},3e4)},Math.random()*1e4),setTimeout(()=>{setInterval(()=>{i.lastSelectedProduct&&A(i.products,i.lastSelectedProduct,C)},6e4)},Math.random()*2e4)},C=()=>{b.innerHTML=c.ProductOptions()};j();
