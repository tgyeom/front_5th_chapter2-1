import"./modulepreload-polyfill-B5Qt9EMX.js";const f=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}],u={quantityChange:"quantity-change",removeItem:"remove-item"},D=(t,e)=>()=>{const n=t.value;e(n)},k=(t,e,n)=>{const o=t.target;if(o.classList.contains(u.quantityChange)){const s=o.dataset.productId,i=parseInt(o.dataset.change);e(s,i)}else if(o.classList.contains(u.removeItem)){const s=o.dataset.productId;n(s)}},B=(t,e)=>{const n=Math.floor(Math.random()*t.length),o=t[n];Math.random()<.3&&o.quantity>0&&(o.price=Math.round(o.price*.8),alert(`번개세일! ${o.name}이(가) 20% 할인 중입니다!`),e())},A=(t,e,n)=>{const o=t.find(s=>s.id!==e&&s.quantity>0);o&&(o.price=Math.round(o.price*.95),alert(`${o.name}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`),n())},H=(t,e,n,o)=>{let s=0,i=0,c=0;for(let r=0;r<t.length;r++){const l=t[r],E=l.id,L=e(E),b=n(l),v=L.price*b;i+=b,c+=v;let w=b>=10?o(E):0;s+=v*(1-w)}if(i>=30){const r=c*.25,l=c-s;r>l&&(s=c*.75)}let I=!1;new Date().getDay()===2&&(I=!0,s*=.9);const M=c>0?(c-s)/c:0,S=Math.floor(s/1e3);return{totalAmount:s,itemCount:i,subtotal:c,discountRate:M,isTuesdayDiscount:I,bonusPoints:S}},Q=t=>({p1:.1,p2:.15,p3:.2,p4:.05,p5:.25})[t]||0,R=(t,e)=>{let n=`총액: ${Math.round(t)}원`;return e>0&&(n+=`<span class="text-green-500 ml-2">(${(e*100).toFixed(1)}% 할인 적용)</span>`),n},O=t=>`
        <span>${t.name} - ${t.price}원 x 1</span>
        <div>
          <button class="${u.quantityChange} bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
          <button class="${u.quantityChange} bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
          <button class="${u.removeItem} bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
        </div>
    `,U=t=>`<span id="loyalty-points" class="text-blue-500 ml-2">(포인트: ${t})</span>`,j=()=>{let t="";return f.forEach(function(e){const n=e.quantity===0?"disabled":"";t+=`<option value="${e.id}" ${n}>${e.name} - ${e.price}원</option>`}),t},F=()=>{let t="";return f.forEach(function(e){e.quantity<5&&(t+=`${e.name}: ${e.quantity>0?"재고 부족 ("+e.quantity+"개 남음)":"품절"}<br>`)}),t},d={CartTotal:R,CartItem:O,Points:U,ProductOptions:j,StockStatus:F},a={products:[...f],lastSelectedProduct:null,bonusPoints:0,totalAmount:0,itemCount:0};let p,m,h,q,$;const N=()=>{_(),z(),G(),Y(),g()},_=()=>{const t=document.getElementById("app");t.innerHTML=`
    <div class="bg-gray-100 p-8">
      <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
        <h1 class="text-2xl font-bold mb-4">장바구니</h1>
        <div id="cart-items"></div>
        <div id="cart-total" class="text-xl font-bold my-4"></div>
        <div class="flex mb-4">
          <select id="product-select" class="border rounded p-2 mr-2">
            ${d.ProductOptions()}
          </select>
          <button id="add-to-cart" class="bg-blue-500 text-white px-4 py-2 rounded">추가</button>
        </div>
        <div id="stock-status" class="text-sm text-gray-500 mt-2"></div>
      </div>
    </div>
  `},z=()=>{p=document.getElementById("cart-items"),m=document.getElementById("cart-total"),h=document.getElementById("product-select"),q=document.getElementById("add-to-cart"),$=document.getElementById("stock-status")},G=()=>{q.addEventListener("click",D(h,J)),p.addEventListener("click",t=>k(t,P,T))},y=t=>a.products.find(e=>e.id===t),J=t=>{const e=y(t);if(!e||e.quantity<=0){alert("재고가 부족합니다.");return}if(document.getElementById(t))P(t,1);else{const o=K(e);p.appendChild(o),e.quantity--}a.lastSelectedProduct=t,g()},K=t=>{const e=document.createElement("div");return e.id=t.id,e.className="flex justify-between items-center mb-2",e.innerHTML=d.CartItem(t),e},P=(t,e)=>{const n=document.getElementById(t),o=y(t);if(!n||!o)return;const i=x(n)+e;if(i<=0){T(t);return}if(e>0&&o.quantity<=0){alert("재고가 부족합니다.");return}V(n,o,i),o.quantity-=e,g()},x=t=>parseInt(t.querySelector("span").textContent.split("x ")[1]),V=(t,e,n)=>{t.querySelector("span").textContent=`${e.name} - ${e.price}원 x ${n}`},T=t=>{const e=document.getElementById(t),n=y(t);if(!e||!n)return;const o=x(e);n.quantity+=o,e.remove(),g()},g=()=>{const t=H(p.children,y,x,Q);a.totalAmount=t.totalAmount,a.itemCount=t.itemCount,a.bonusPoints=t.bonusPoints,W(t.discountRate,t.isTuesdayDiscount),X()},W=(t,e)=>{e?m.innerHTML=`총액: ${Math.round(a.totalAmount)}원<span class="text-green-500 ml-2">(10.0% 할인 적용)</span>`:m.innerHTML=d.CartTotal(a.totalAmount,t);let n=document.getElementById("loyalty-points");n?n.innerHTML=`(포인트: ${a.bonusPoints})`:m.innerHTML+=d.Points(a.bonusPoints)},X=()=>{$.innerHTML=d.StockStatus()},Y=()=>{setTimeout(()=>{setInterval(()=>{B(a.products,C)},3e4)},Math.random()*1e4),setTimeout(()=>{setInterval(()=>{a.lastSelectedProduct&&A(a.products,a.lastSelectedProduct,C)},6e4)},Math.random()*2e4)},C=()=>{h.innerHTML=d.ProductOptions()};N();
